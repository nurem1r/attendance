<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Teacher Time Slots</title>
    <style>
        /* Strict / professional inline style for Teacher Slots */
        :root{
            --bg:#f5f7fb; --card:#fff; --text:#0f1724; --muted:#6b7280; --primary:#0b5ed7;
            --border:#e6eefc; --radius:8px; --shadow:0 12px 36px rgba(8,20,50,0.06);
        }
        *{box-sizing:border-box}
        body{margin:0;background:linear-gradient(180deg,var(--bg), #eef6ff);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;color:var(--text);padding:28px}
        .container{max-width:1200px;margin:0 auto}
        .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}
        .title{font-size:1.4rem;font-weight:700}
        .back{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:8px;background:#f0f6ff;color:var(--primary);text-decoration:none;border:1px solid var(--border);font-weight:700}
        .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:16px;box-shadow:var(--shadow)}
        .slot-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:14px;margin-top:14px}
        .slot-card{background:linear-gradient(180deg,#fff,#fbfdff);border-radius:8px;padding:14px;border:1px solid var(--border);display:flex;flex-direction:column;gap:10px;min-height:120px}
        .slot-header{display:flex;justify-content:space-between;align-items:center}
        .slot-time{font-weight:700;color:var(--primary)}
        .slot-id{font-size:0.85rem;color:var(--muted);background:#f0f6ff;padding:6px 10px;border-radius:999px;border:1px solid rgba(11,94,215,0.06)}
        .students-list{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:8px}
        .student-item{padding:10px;border-radius:6px;background:#fbfdff;border:1px solid #eef4ff;display:flex;justify-content:space-between;align-items:center}
        .student-name{font-weight:700}
        .student-status{font-weight:700;padding:6px 10px;border-radius:999px;font-size:0.85rem}
        .present{background:#e9f7ef;color:#0b6b3a}
        .absent{background:#fff1f0;color:#8b1c1c}
        .late{background:#fff7ed;color:#7a4c11}
        .move-form{margin-top:8px;padding:10px;border-radius:6px;border:1px solid #eef4ff;background:#fff}
        .small{font-size:0.9rem;color:var(--muted)}
        .center{display:flex;align-items:center;justify-content:center}
        @media (max-width:600px){ .slot-grid{grid-template-columns:1fr} }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <div class="title">Teacher Time Slots</div>
        <a th:href="@{/manager}" class="back">Back to Dashboard</a>
    </div>

    <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:12px">
            <div>
                <div class="small" style="font-weight:700">Teacher:</div>
                <div th:text="${teacher.firstName + ' ' + teacher.lastName}" style="font-weight:800"></div>
            </div>
            <div class="small" style="color:var(--muted)">Showing slots for this teacher</div>
        </div>

        <div class="slot-grid">
            <div th:each="slot, stat : ${slots}"
                 th:with="cnt=${studentsBySlot != null and studentsBySlot[slot.id] != null ? #lists.size(studentsBySlot[slot.id]) : 0}"
                 class="slot-card"
                 th:classappend="${cnt >= 3} ? ' high-occupancy' : (cnt == 2 ? ' medium-occupancy' : (cnt == 1 ? ' low-occupancy' : ''))">
                <div class="slot-header">
                    <div class="slot-time" th:text="${slot.label}">08:00-09:00</div>
                    <div class="slot-id">ID: <span th:text="${slot.id}">0</span></div>
                </div>

                <div>
                    <div class="small" style="margin-bottom:8px;font-weight:700">Students</div>
                    <ul class="students-list">
                        <li th:each="s : ${studentsBySlot != null and studentsBySlot[slot.id] != null ? studentsBySlot[slot.id] : T(java.util.Collections).emptyList()}"
                            class="student-item">
                            <span class="student-name" th:text="${s.firstName + ' ' + s.lastName}">Student Name</span>
                            <span th:classappend="${todays != null and todays.containsKey(s.id) ? (todays[s.id].status.name() == 'PRESENT' ? ' student-status present' : (todays[s.id].status.name() == 'ABSENT' ? ' student-status absent' : ' student-status late')) : ' small'}"
                                  th:text="${todays != null and todays.containsKey(s.id) ? todays[s.id].status.name() : 'Not'}">Status</span>
                        </li>
                        <li th:if="${studentsBySlot == null or studentsBySlot[slot.id] == null or #lists.isEmpty(studentsBySlot[slot.id])}" class="small">No students assigned</li>
                    </ul>
                </div>

                <div class="move-form">
                    <div class="small" style="font-weight:700;margin-bottom:6px">Move student</div>
                    <form th:action="@{/manager/move_student}" method="post" style="display:flex;gap:8px;align-items:center">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <select name="studentId" style="flex:1;padding:8px;border-radius:6px;border:1px solid #e6eefc">
                            <option value="" disabled selected>Select student</option>
                            <option th:each="s : ${studentsBySlot != null and studentsBySlot[slot.id] != null ? studentsBySlot[slot.id] : T(java.util.Collections).emptyList()}" th:value="${s.id}" th:text="${s.firstName + ' ' + s.lastName}"></option>
                        </select>
                        <select name="targetSlotId" style="padding:8px;border-radius:6px;border:1px solid #e6eefc">
                            <option value="" disabled selected>To slot</option>
                            <option th:each="slt : ${slots}" th:value="${slt.id}" th:text="${slt.label}"></option>
                        </select>
                        <button type="submit" class="center" style="padding:8px 10px;border-radius:6px;background:linear-gradient(135deg,var(--primary),#093a88);color:#fff;border:none;font-weight:700">Move</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>