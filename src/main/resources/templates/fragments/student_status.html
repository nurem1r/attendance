<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Статус студента</title>
    <link rel="stylesheet" th:href="@{/css/app.css}" href="/css/app.css"/>
</head>
<body>
<div class="container">
    <div class="header-row">
        <div class="header-left">
            <h1 th:text="${student.lastName + ' ' + student.firstName}">Студент</h1>
            <div class="small" th:text="'Пакет: ' + (student.lessonPackage != null ? student.lessonPackage.title : student.packageCode)">Пакет</div>
        </div>
        <div class="header-actions">
            <a th:href="@{/manager/student_list}" class="btn-consume">Назад</a>
        </div>
    </div>

    <div class="table-card">
        <div style="display:flex;gap:12px;margin-bottom:12px">
            <div class="kv">Остаток: <strong th:text="${student.remainingLessons == null ? '-' : student.remainingLessons}">0</strong></div>
            <div class="kv">Стоимость: <strong th:text="${student.packagePrice == null ? '-' : student.packagePrice}">0</strong></div>
            <div class="kv">Долг: <strong th:text="${student.debt == null ? 0 : student.debt}">0</strong></div>
        </div>

        <table>
            <thead>
            <tr><th>Дата</th><th>Статус</th><th>Отмечено</th><th>Время прихода</th></tr>
            </thead>
            <tbody>
            <tr th:each="a : ${attendances}">
                <td th:text="${#dates.format(a.lessonDate, 'yyyy-MM-dd')}">2025-12-01</td>
                <td>
              <span th:switch="${a.status}">
                <span th:case="'PRESENT'" class="pill present">Присутствует</span>
                <span th:case="'LATE'" class="pill late">Опоздал</span>
                <span th:case="'ABSENT'" class="pill absent">Отсутствует</span>
                <span th:case="'EXCUSED'" class="pill excused">Освобождён</span>
                <span th:case="*">${a.status}</span>
              </span>
                </td>
                <td th:text="${a.markedByUserId}">user</td>
                <td th:text="${a.checkinTime == null ? 'N/A' : #dates.format(a.checkinTime, 'HH:mm')}">--:--</td>
            </tr>
            <tr th:if="${attendances == null || #lists.isEmpty(attendances)}">
                <td colspan="4" class="small">Записей нет</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>