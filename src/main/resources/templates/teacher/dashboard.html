<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Дашборд учителя</title>
    <link rel="stylesheet" th:href="@{/css/app.css}" href="/css/app.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <meta th:if="${_csrf != null}" name="_csrf" th:content="${_csrf.token}"/>
    <meta th:if="${_csrf != null}" name="_csrf_header" th:content="${_csrf.headerName}"/>
    <meta name="min-date" th:content="${@environment.getProperty('attendance.minDate','2025-12-01')}" />
    <style>
        /* action buttons restored to compact size and previous-ish colors */
        .actions { display:flex; gap:8px; align-items:center; }
        .action-btn {
            display:inline-flex;
            align-items:center;
            justify-content:center;
            width:36px;
            height:36px;
            border-radius:8px;
            cursor:pointer;
            border:none;
            color:white;
            box-shadow:0 4px 10px rgba(0,0,0,0.08);
            transition:transform .12s ease, box-shadow .12s ease, opacity .12s;
            font-size:0.95rem;
        }
        .action-present { background: linear-gradient(135deg,#48bb78,#38a169); } /* green */
        .action-late    { background: linear-gradient(135deg,#f6ad55,#ed8936); } /* orange */
        .action-absent  { background: linear-gradient(135deg,#f56565,#e53e3e); } /* red */
        .action-excused { background: linear-gradient(135deg,#60a5fa,#3b82f6); } /* calm blue */

        .action-btn i { font-size:1.05rem; }

        /* extra control compact */
        .extra-compact { padding:6px 8px; border-radius:6px; background:#60a5fa; color:#fff; font-weight:600; }
        .extra-panel { display:flex; align-items:center; gap:6px; padding:4px; border-radius:6px; background:#fff; border:1px solid #e2e8f0; }
        .extra-panel button { width:28px; height:28px; border-radius:6px; border:none; cursor:pointer; background:#fff; box-shadow:0 2px 8px rgba(0,0,0,0.06); }

        /* row highlight classes (keeps text color unchanged) */
        .row-debt { background: linear-gradient(90deg, rgba(255,230,230,0.95) 0%, rgba(255,255,255,1) 100%); border-left: 8px solid #c62828; box-shadow: 0 6px 20px rgba(198,40,40,0.03); }
        .row-warn { background: linear-gradient(90deg, rgba(255,252,240,0.95) 0%, rgba(255,255,255,1) 100%); border-left: 8px solid #ed8936; }
        .row-low { background: linear-gradient(90deg, rgba(255,245,230,0.95) 0%, rgba(255,255,255,1) 100%); border-left: 8px solid #ff8f00; }

        .negative-warning { color:#b91c1c; font-weight:700; margin-left:8px; font-size:0.9rem; }

        /* debt cell styling - uses existing app.css rules if any; keep bold for emphasis */
        td.debt-cell { font-weight:700; text-align:right; padding-right:12px; min-width:110px; }

        .student-link { /* no special cursor/underline — disabled */ }
        /* keep other table styles as in app.css */
    </style>
</head>
<body>
<div class="container">
    <div class="header-row">
        <div class="header-left">
            <h1>Дашборд учителя</h1>
            <div class="small">Отметки посещаемости — выбирайте дату и отмечайте студентов</div>
        </div>
        <div class="header-actions">
            <form th:action="@{/logout}" method="post" th:object="${_csrf}">
                <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                <button type="submit" class="btn-consume">Выйти</button>
            </form>
            <button id="saveChangesBtn" class="btn-consume">Сохранить изменения</button>
        </div>
    </div>

    <div class="controls">
    <span class="calendar-wrap">Дата:
      <input id="datePicker" type="text" class="flatpickr-input" />
    </span>
        <small id="minDateNote" style="margin-left:12px;color:#718096"
               th:text="'Минимальная дата: ' + ${@environment.getProperty('attendance.minDate','2025-12-01')}"></small>
    </div>

    <div class="table-card" id="attendanceCard">
        <table id="studentsTable">
            <thead>
            <tr>
                <th>Фамилия и имя</th>
                <th>Пакет</th>
                <th>Книга</th>
                <th>Остаток</th>
                <th>Долг (сом)</th>
                <th>Статус</th>
                <th>Действия</th>
            </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
</div>

<!-- drawer removed while student_status is frozen -->

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="/js/teacher-dashboard.js"></script>
</body>
</html>